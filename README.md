# SuccBankTransactions

## Описание проекта

SuccBankTransactions - это проект, разработанный на Python для маскировки номеров банковских карт и счетов.

## Установка

Чтобы установить и использовать проект, выполните следующие шаги:

1. **Клонирование репозитория**

git clone https://github.com/arturkoltyrin/SuccBankTransactions.git

2. **Установка зависимостей**

Убедитесь, что у вас установлен Poetry.

Затем выполните команду: poetry install

3. **Запуск проекта**

Вы можете запустить проект и использовать его функции
в интерактивной оболочке, используя:
   
poetry run python

## Использование

Проект содержит несколько модулей:

### Модуль `masks`

#### Функции:

**`get_mask_card_number(card_number: str)`**

Маскирует номер банковской карты. 
Возвращает строку в формате `XXXX XX** **** XXXX`, где X – цифры карты.

**Пример использования:**
  
from src.masks import get_mask_card_number

masked_card = get_mask_card_number("7000792289606361")

print(masked_card) 

Вывод: XXXX XX90 **** 6361

**`get_mask_account(account_number: str)`**

Маскирует номер банковского счета.
Возвращает строку в формате `**XXXX`, где X – цифры счета.

**Пример использования:**

from src.masks import get_mask_account

masked_account = get_mask_account("73654108430135874305")

print(masked_account) # Вывод: **8305

### Модуль `widget`

#### Функции:

**`mask_account_card(info: str)`**

Маскирует номер карты или счета в зависимости
от указанного типа (карта или счет). 
Принимает строку, содержащую тип и номер.

**Пример использования:**

from src.widget import mask_account_card

masked_info = mask_account_card("Visa Platinum 7000792289606361")

print(masked_info) # Вывод: XXXX XX90 **** 6361

masked_account_info = mask_account_card("Счет 73654108430135874305")

print(masked_account_info) 

Вывод: **8305

**`get_date(date_str: str)`**

Преобразует строку с датой в формат `DD.MM.YYYY`.

**Пример использования:**

from src.widget import get_date

formatted_date = get_date("2024-03-11T02:26:18.671407")

print(formatted_date)

Вывод: 11.03.2024

### Модуль `processing`

#### Функции:

**`filter_by_state(transactions: List[Dict], state: str = 'EXECUTED')`**

Фильтрует транзакции по состоянию. 
Возвращает только те транзакции, 
у которых состояние соответствует указанному значению.

**Пример использования:**

from src.processing import filter_by_state

transactions = [{'state': 'EXECUTED', 'amount': 100}]

executed_transactions = filter_by_state(transactions)

print(executed_transactions) # Вывод: [{'state': 'EXECUTED', 'amount': 100}]

**`sort_by_date(transactions: List[Dict], order: str = 'desc')`**

Сортирует транзакции по дате. Поддерживает сортировку по возрастанию и убыванию.

**Пример использования:**

from src.processing import sort_by_date

transactions = [{'date': '2024-03-11', 'amount': 100}]

sorted_transactions = sort_by_date(transactions, order='asc')

print(sorted_transactions)

Вывод: [{'date': '2024-03-10', 'amount': 50}]

## Тестирование модуля

В проекте реализованы тесты для проверок функций, 
связанных с обработкой и форматированием данных. 
Все тесты написаны с использованием библиотеки `pytest`.

### Тестируемые функции

### 1. `get_date`
Функция `get_date` преобразует дату из строкового формата 
в более удобный вид (формат `DD.MM.YYYY`).

#### Тесты:
- Входные данные: `"2024-03-11T02:26:18.671407"` → Ожидаемый результат: `"11.03.2024"`
- Входные данные: `"2023-01-01T02:26:18.671407"` → Ожидаемый результат: `"01.01.2023"`
- Некорректный ввод (пустая строка) вызывает исключение `ValueError` 
с сообщением "Данные отсутствуют".

### 2. `mask_account_card`
Функция `mask_account_card` маскирует номера банковских карт и счетов, 
оставляя только последние 4 цифры.

#### Тесты:
- Входные данные: `"Maestro 1596837868705199"` → Ожидаемый результат: `"Maestro 1596 83** **** 5199"`
- Входные данные: `"Счет 64686473678894779589"` → Ожидаемый результат: `"Счет **9589"`
- Входные данные: `"MasterCard 7158300734726758"` → Ожидаемый результат: `"MasterCard 7158 30** **** 6758"`
- Также тестируются другие типы карт и счетов с аналогичными ожиданиями.

### 3. `get_mask_card_number`
Функция `get_mask_card_number` возвращает замаскированный номер карты, 
оставляя только последние 4 цифры.

#### Тесты:
- Входные данные: `"Maestro 1596837868705199"` → Ожидаемый результат: `"1596 83** **** 5199"`
- Входные данные: `"Счет 64686473678894779589"` → Ожидаемый результат: `"**9589"`
- При неверном вводе (например, отсутствие названия или номера) 
вызывается `ValueError`.

### 4. `get_mask_account`
Функция `get_mask_account` маскирует номера счетов, оставляя только последние 4 цифры.

#### Тесты:
- Входные данные: `"73654108430135874305"` → Ожидаемый результат: `"**4305"`
- Входные данные: `"84930254671289437564"` → Ожидаемый результат: `"**7564"`
- Тестируются и другие номера счетов.

### 5. `filter_by_state`
Функция `filter_by_state` фильтрует список словарей по заданному состоянию (`state`).

#### Тесты:
- Входные данные: список с состояниями `["EXECUTED", "CANCELED"]`
→ Ожидаемый результат: `[{ "state": "EXECUTED", "amount": 100 }, { "state": "EXECUTED", "amount": 300 }]`
- При фильтрации по несуществующему состоянию возвращается пустой список.

### 6. `sort_by_date`
Функция `sort_by_date` сортирует список словарей по дате.

#### Тесты:
- Входные данные с датами в различном порядке → Сортировка по возрастанию и убыванию дате.
- Проверяется, что данные правильно сортируются в соответствии с заданным параметром `reverse`.

### Запуск тестов

Для выполнения тестов необходимо иметь установленный `pytest`. 
Можно запустить тесты с помощью команды  `pytest`.

## Проверка качества кода

Проект использует следующие инструменты:

- **Flake8** для проверки стиля кода.
- **Black** для автоматического форматирования кода.
- **isort** для упорядочивания импортов.
- **Mypy** для статической проверки типов.

## Лицензия

Этот проект лицензирован под MIT License.